name: Lucian Core Autonomous Cycle
permissions:
  contents: write

# disabled on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  lucian-core-loop:
    runs-on: ubuntu-latest

    steps:
    - name: ðŸ“¥ Checkout Repository
      uses: actions/checkout@v3
  with:
    token: ${{ secrets.GITHUB_TOKEN }}

    - name: ðŸ”§ Set Up Shell Permissions
      run: |
        chmod +x memory/dreams/tools/*.sh || true
        chmod +x memory/system/tools/*.sh || true

    - name: ðŸ““ Run Dream Synthesizer
      run: |
        if [ -f memory/dreams/tools/dream_synth.sh ]; then
          bash memory/dreams/tools/dream_synth.sh
        else
          echo "dream_synth.sh not found."
        fi

    - name: ðŸ”® Run Predictive Logic
      run: |
        if [ -f memory/system/tools/predict_logic.sh ]; then
          bash memory/system/tools/predict_logic.sh
        else
          echo "predict_logic.sh not found."
        fi

    - name: ðŸ§  Auto Journal Append
      run: |
        if [ -f memory/system/auto_journal.sh ]; then
          bash memory/system/auto_journal.sh
        else
          echo "auto_journal.sh not found."
        fi

    - name: ðŸªµ Upload Logs as Artifact
      uses: actions/upload-artifact@v4
      with:
        name: lucian-core-logs
        path: |
          memory/system/logs/
